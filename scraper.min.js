javascript:(function(){function extractActivities(){let e=document.querySelectorAll(".activity-title.visually-hidden"),t=[];return e.forEach((e=>{let n=e.textContent.trim();if(!n.includes("No activity")&&!n.includes("Blocked")){let i=e.nextSibling.nextSibling.nextSibling.textContent.trim();t.push(n+" times"+i)}})),t.map(parseActivity)}function parseActivity(e){let[t,n]=e.split(" times"),[i,r,...a]=t.split(" "),c=a.join(" ").split("M ")[1],[l,o]=n.split(" - "),[s,d]=parseTime(l),[m,p]=parseTime(o),u=(new Date).getFullYear(),S=(new Date).getMonth(),A=new Date(u,S,i,s,d),D=new Date(u,S,i,m,p);return{summary:c,start:{dateTime:A.toISOString(),timeZone:"America/Los_Angeles"},end:{dateTime:D.toISOString(),timeZone:"America/Los_Angeles"}}}function parseTime(e){let[t,n]=e.replace("AM","").replace("PM","").replace("(","").replace(")","").trim().split(":");return e.includes("PM")&&"12"!==t&&(t=parseInt(t)+12),e.includes("AM")&&"12"===t&&(t="00"),[t,n]}function convertToICS(e){let t=new Date,n=t.getDay(),i=t.getDate()-n+(0==n?-6:0),r=new Date(t.setDate(i));r.setHours(0,0,0,0);let a=0;return"BEGIN:VCALENDAR\r\nVERSION:2.0\r\nPRODID:-//Shopify//Event scraper//EN\r\n"+e.map((e=>(a+=1,"BEGIN:VEVENT\r\nDTSTART:"+e.start.dateTime.replace(/[-:]|\.\d{3}/g,"")+"\r\nDTEND:"+e.end.dateTime.replace(/[-:]|\.\d{3}/g,"")+"\r\nSUMMARY:"+e.summary+"\r\nDTSTAMP:"+r.toISOString().replace(/[-:]|\.\d{3}/g,"")+"\r\nUID:nice"+a+"\r\nEND:VEVENT"))).join("\r\n")+"\r\nEND:VCALENDAR"}function downloadICS(e){let t=new Blob([e],{type:"text/calendar;charset=utf-8"}),n=URL.createObjectURL(t),i=document.createElement("a");i.download="events.ics",i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i)}function keepAlive(){document.querySelector(".btn-refresh").click()}try{let e=extractActivities(),t=convertToICS(e);downloadICS(t),setInterval((()=>{e=extractActivities(),t=convertToICS(e),downloadICS(t)}),6e5),setInterval(keepAlive,6e4)}catch(e){}})();