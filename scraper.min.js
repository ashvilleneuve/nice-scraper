javascript:(function(){function extractActivities(){let e=document.querySelectorAll(".activity-title.visually-hidden"),t=[];e.forEach((e=>{let n=e.textContent.trim();if(!n.includes("No activity")&&!n.includes("Blocked")){let i=e.nextSibling.nextSibling.nextSibling.textContent.trim();t.push(n+" times"+i)}}));let n=[],i=(new Date).getFullYear(),l=(new Date).getMonth();return t.forEach((e=>{let t=e.split(" times")[0],[r,c,...s]=t.split(" "),a=e.split(" times")[1],o=s.join(" ").split("M ")[1],d=a.split("(")[1].split(" - ")[0].replace("AM","").replace("PM","").trim(),p=a.split(" - ")[1].split(")")[0].replace("AM","").replace("PM","").trim(),m=a.split("(")[1].split(" - ")[0].includes("AM")?"AM":"PM",u=a.split(" - ")[1].split(")")[0].includes("AM")?"AM":"PM",[A,b]=d.split(":"),[v,D]=p.split(":");"PM"===m&&"12"!==A&&(A=parseInt(A)+12),"PM"===u&&"12"!==v&&(v=parseInt(v)+12),"AM"===m&&"12"===A&&(A="00"),"AM"===u&&"12"===v&&(v="00");let M=new Date(i,l,r,A,b),S=new Date(i,l,r,v,D);n.push({summary:o,start:{dateTime:M.toISOString(),timeZone:"America/Los_Angeles"},end:{dateTime:S.toISOString(),timeZone:"America/Los_Angeles"}})})),n}function convertToICS(e){let t=new Date,n=t.getDay(),i=t.getDate()-n+(0==n?-6:0),l=new Date(t.setDate(i));l.setHours(0,0,0,0);let r=0;return"BEGIN:VCALENDAR\r\nVERSION:2.0\r\nPRODID:-//Shopify//Event scraper//EN\r\n"+e.map((e=>(r+=1,"BEGIN:VEVENT\r\nDTSTART:"+e.start.dateTime.replace(/[-:]|\.\d{3}/g,"")+"\r\nDTEND:"+e.end.dateTime.replace(/[-:]|\.\d{3}/g,"")+"\r\nSUMMARY:"+e.summary+"\r\nDTSTAMP:"+l.toISOString().replace(/[-:]|\.\d{3}/g,"")+"\r\nUID:nice"+r+"\r\nEND:VEVENT"))).join("\r\n")+"\r\nEND:VCALENDAR"}let events=extractActivities(),ics=convertToICS(events),blob=new Blob([ics],{type:"text/calendar;charset=utf-8"}),url=URL.createObjectURL(blob),link=document.createElement("a");link.download="events.ics",link.href=url,document.body.appendChild(link),link.click(),document.body.removeChild(link),setInterval((()=>{events=extractActivities(),ics=convertToICS(events),blob=new Blob([ics],{type:"text/calendar;charset=utf-8"}),url=URL.createObjectURL(blob),link=document.createElement("a"),link.download="events.ics",link.href=url,document.body.appendChild(link),link.click(),document.body.removeChild(link)}),12e5),setInterval((()=>{document.querySelector(".btn-refresh").click()}),6e4);})();