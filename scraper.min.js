javascript:(function(){function extractActivities(){let e=document.querySelectorAll(".activity-title.visually-hidden"),t=[];return e.forEach((e=>{let n=e.textContent.trim();if(!n.includes("No activity")&&!n.includes("Blocked")){let i=e.nextSibling.nextSibling.nextSibling.textContent.trim();t.push(n+" times"+i)}})),t.map(parseActivity)}function parseActivity(e){let t=document.querySelector("eem-date-navigator #input-mask").textContent.split("| ")[1],n=t.split(" – ")[0].split("-")[0],i=t.split(" – ")[1].split("-")[0],r=n!=i,[a,l]=e.split(" times"),[c,o,...s]=a.split(" "),u=s.join(" ").split("M ")[1],[d,p]=l.split(" - "),[m,g]=parseTime(d),[S,v]=parseTime(p),A=(new Date).getFullYear(),D=getMonthNumber(r&&c<7?i:n),T=new Date(A,D,c,m,g),y=new Date(A,D,c,S,v);return{summary:u,start:{dateTime:T.toISOString(),timeZone:"America/Los_Angeles"},end:{dateTime:y.toISOString(),timeZone:"America/Los_Angeles"}}}function parseTime(e){let[t,n]=e.replace("AM","").replace("PM","").replace("(","").replace(")","").trim().split(":");return e.includes("PM")&&"12"!==t&&(t=parseInt(t)+12),e.includes("AM")&&"12"===t&&(t="00"),[t,n]}function getMonthNumber(e){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(e)}function convertToICS(e){let t=new Date,n=t.getDay(),i=t.getDate()-n+(0==n?-6:0),r=new Date(t.setDate(i));r.setHours(0,0,0,0);let a=0;return"BEGIN:VCALENDAR\r\nVERSION:2.0\r\nPRODID:-//Shopify//Event scraper//EN\r\n"+e.map((e=>{let t=new Date(e.start.dateTime),n=t.getUTCDate(),i=t.getUTCMonth(),l=t.getFullYear();return a=a+l+i+n+1,"BEGIN:VEVENT\r\nDTSTART:"+e.start.dateTime.replace(/[-:]|\.\d{3}/g,"")+"\r\nDTEND:"+e.end.dateTime.replace(/[-:]|\.\d{3}/g,"")+"\r\nSUMMARY:"+e.summary+"\r\nDTSTAMP:"+r.toISOString().replace(/[-:]|\.\d{3}/g,"")+"\r\nUID:nicescraper"+a+"\r\nEND:VEVENT"})).join("\r\n")+"\r\nEND:VCALENDAR"}function downloadICS(e){let t=new Blob([e],{type:"text/calendar;charset=utf-8"}),n=URL.createObjectURL(t),i=document.createElement("a");i.download="events.ics",i.href=n,document.body.appendChild(i),i.click(),document.body.removeChild(i)}function keepAlive(){document.querySelector(".btn-refresh").click()}function oktaWatch(){const e=document.getElementById("okta-plugin-message-channel-available");new MutationObserver(((e,t)=>{for(const t of e)"childList"===t.type||t.type})).observe(e,{attributes:!0,childList:!0,subtree:!0})}try{let e=extractActivities(),t=convertToICS(e);downloadICS(t),oktaWatch(),setInterval((()=>{e=extractActivities(),t=convertToICS(e),downloadICS(t)}),6e5),setInterval(keepAlive,6e4)}catch(e){console.error("An error has occured",e)}})();